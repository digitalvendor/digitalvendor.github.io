<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#9333ea">
    <meta name="description" content="The only planner designed for ADHD brains that actually works">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>ADHD Digital Planner</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
        #root { min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Plus, Trash2, Play, Pause, RotateCcw, CheckCircle, Circle, Zap, Brain, Clock, Target, TrendingUp, Sparkles } = (() => {
            const iconProps = { className: 'w-5 h-5' };
            return {
                Plus: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M12 4v16m8-8H4' })),
                Trash2: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16' })),
                Play: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z' }), React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M21 12a9 9 0 11-18 0 9 9 0 0118 0z' })),
                Pause: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z' })),
                RotateCcw: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15' })),
                CheckCircle: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' })),
                Circle: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('circle', { cx: 12, cy: 12, r: 10, strokeWidth: 2 })),
                Zap: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M13 10V3L4 14h7v7l9-11h-7z' })),
                Brain: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z' })),
                Clock: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z' })),
                Target: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('circle', { cx: 12, cy: 12, r: 10, strokeWidth: 2 }), React.createElement('circle', { cx: 12, cy: 12, r: 6, strokeWidth: 2 }), React.createElement('circle', { cx: 12, cy: 12, r: 2, strokeWidth: 2 })),
                TrendingUp: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M13 7h8m0 0v8m0-8l-8 8-4-4-6 6' })),
                Sparkles: (props) => React.createElement('svg', { ...iconProps, ...props, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', stroke: 'currentColor' }, React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z' }))
            };
        })();

        // Simple storage polyfill for browsers
        if (!window.storage) {
            window.storage = {
                get: async (key) => {
                    const value = localStorage.getItem(key);
                    return value ? { key, value } : null;
                },
                set: async (key, value) => {
                    localStorage.setItem(key, value);
                    return { key, value };
                },
                delete: async (key) => {
                    localStorage.removeItem(key);
                    return { key, deleted: true };
                }
            };
        }

        function ADHDPlanner() {
          const [activeTab, setActiveTab] = useState('today');
          const [currentDate, setCurrentDate] = useState(new Date());
          const [selectedDate, setSelectedDate] = useState(new Date());
          const [brainDump, setBrainDump] = useState([]);
          const [brainInput, setBrainInput] = useState('');
          const [tasks, setTasks] = useState({});
          const [taskInput, setTaskInput] = useState('');
          const [taskPriority, setTaskPriority] = useState('medium');
          const [taskTime, setTaskTime] = useState(30);
          const [taskDate, setTaskDate] = useState(() => {
            const today = new Date();
            return `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
          });
          const [habits, setHabits] = useState([
            { id: 1, name: 'Drink Water', streak: 0, lastCompleted: null },
            { id: 2, name: 'Exercise', streak: 0, lastCompleted: null },
            { id: 3, name: 'Meditate', streak: 0, lastCompleted: null },
          ]);
          const [habitCompletions, setHabitCompletions] = useState({});
          const [newHabit, setNewHabit] = useState('');
          const [timerMinutes, setTimerMinutes] = useState(25);
          const [timerSeconds, setTimerSeconds] = useState(0);
          const [isTimerRunning, setIsTimerRunning] = useState(false);
          const [timerMode, setTimerMode] = useState('focus');
          const [dailyStats, setDailyStats] = useState({});
          const [points, setPoints] = useState(0);
          const [timeBlocks, setTimeBlocks] = useState({});
          const [blockInput, setBlockInput] = useState('');
          const [blockTime, setBlockTime] = useState('09:00');
          const [blockDate, setBlockDate] = useState(() => {
            const today = new Date();
            return `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
          });
          const [showReview, setShowReview] = useState(false);

          // Load data from storage on mount
          useEffect(() => {
            const loadData = async () => {
              try {
                const tasksData = await window.storage.get('adhd-tasks');
                if (tasksData) setTasks(JSON.parse(tasksData.value));

                const habitsData = await window.storage.get('adhd-habits');
                if (habitsData) setHabits(JSON.parse(habitsData.value));

                const habitCompData = await window.storage.get('adhd-habit-completions');
                if (habitCompData) setHabitCompletions(JSON.parse(habitCompData.value));

                const blocksData = await window.storage.get('adhd-time-blocks');
                if (blocksData) setTimeBlocks(JSON.parse(blocksData.value));

                const statsData = await window.storage.get('adhd-daily-stats');
                if (statsData) setDailyStats(JSON.parse(statsData.value));

                const pointsData = await window.storage.get('adhd-points');
                if (pointsData) setPoints(parseInt(pointsData.value));

                const brainData = await window.storage.get('adhd-brain-dump');
                if (brainData) setBrainDump(JSON.parse(brainData.value));
              } catch (error) {
                console.log('First time loading');
              }
            };
            loadData();
          }, []);

          // Save data whenever it changes
          useEffect(() => {
            const saveData = async () => {
              try {
                await window.storage.set('adhd-tasks', JSON.stringify(tasks));
                await window.storage.set('adhd-habits', JSON.stringify(habits));
                await window.storage.set('adhd-habit-completions', JSON.stringify(habitCompletions));
                await window.storage.set('adhd-time-blocks', JSON.stringify(timeBlocks));
                await window.storage.set('adhd-daily-stats', JSON.stringify(dailyStats));
                await window.storage.set('adhd-points', points.toString());
                await window.storage.set('adhd-brain-dump', JSON.stringify(brainDump));
              } catch (error) {
                console.log('Error saving');
              }
            };
            saveData();
          }, [tasks, habits, habitCompletions, timeBlocks, dailyStats, points, brainDump]);

          function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
          }

          function isToday(date) {
            return formatDate(date) === formatDate(currentDate);
          }

          function isFuture(date) {
            return new Date(date) > currentDate;
          }

          function getTodayTasks() {
            const today = formatDate(currentDate);
            return tasks[today] || [];
          }

          function getSelectedDateTasks() {
            const dateKey = formatDate(selectedDate);
            return tasks[dateKey] || [];
          }

          function getTodayBlocks() {
            const today = formatDate(currentDate);
            return timeBlocks[today] || [];
          }

          function getSelectedDateBlocks() {
            const dateKey = formatDate(selectedDate);
            return timeBlocks[dateKey] || [];
          }

          function getTodayStats() {
            const today = formatDate(currentDate);
            if (!dailyStats[today]) {
              dailyStats[today] = { completed: 0, total: 0, points: 0, focusSessions: 0 };
            }
            return dailyStats[today];
          }

          function isHabitCompletedToday(habitId) {
            const today = formatDate(currentDate);
            return habitCompletions[today]?.includes(habitId) || false;
          }

          useEffect(() => {
            let interval;
            if (isTimerRunning) {
              interval = setInterval(() => {
                if (timerSeconds === 0) {
                  if (timerMinutes === 0) {
                    setIsTimerRunning(false);
                    if (timerMode === 'focus') {
                      const today = formatDate(currentDate);
                      setDailyStats(prev => ({
                        ...prev,
                        [today]: {
                          ...getTodayStats(),
                          points: getTodayStats().points + 10,
                          focusSessions: getTodayStats().focusSessions + 1
                        }
                      }));
                      setPoints(p => p + 10);
                    }
                  } else {
                    setTimerMinutes(timerMinutes - 1);
                    setTimerSeconds(59);
                  }
                } else {
                  setTimerSeconds(timerSeconds - 1);
                }
              }, 1000);
            }
            return () => clearInterval(interval);
          }, [isTimerRunning, timerMinutes, timerSeconds, timerMode]);

          useEffect(() => {
            const interval = setInterval(() => {
              const now = new Date();
              if (formatDate(now) !== formatDate(currentDate)) {
                setCurrentDate(now);
                setSelectedDate(now);
                setShowReview(false);
              }
            }, 60000);
            return () => clearInterval(interval);
          }, [currentDate]);

          const addBrainDump = () => {
            if (brainInput.trim()) {
              setBrainDump([...brainDump, { id: Date.now(), text: brainInput, timestamp: new Date() }]);
              setBrainInput('');
            }
          };

          const addTask = () => {
            if (taskInput.trim()) {
              const dateKey = taskDate;
              const newTask = {
                id: Date.now(),
                text: taskInput,
                priority: taskPriority,
                time: taskTime,
                completed: false,
                createdAt: new Date(),
                scheduledFor: taskDate
              };
              
              setTasks(prev => ({
                ...prev,
                [dateKey]: [...(prev[dateKey] || []), newTask]
              }));
              
              setDailyStats(prev => ({
                ...prev,
                [dateKey]: {
                  ...(prev[dateKey] || { completed: 0, total: 0, points: 0, focusSessions: 0 }),
                  total: ((prev[dateKey]?.total || 0) + 1)
                }
              }));
              
              setTaskInput('');
              setTaskDate(formatDate(selectedDate));
            }
          };

          const toggleTask = (dateKey, id) => {
            setTasks(prev => ({
              ...prev,
              [dateKey]: prev[dateKey].map(task => {
                if (task.id === id) {
                  const newCompleted = !task.completed;
                  if (newCompleted) {
                    const taskPoints = task.priority === 'high' ? 15 : task.priority === 'medium' ? 10 : 5;
                    setPoints(p => p + taskPoints);
                    
                    setDailyStats(prevStats => ({
                      ...prevStats,
                      [dateKey]: {
                        ...prevStats[dateKey],
                        completed: prevStats[dateKey].completed + 1,
                        points: prevStats[dateKey].points + taskPoints
                      }
                    }));
                  } else {
                    const taskPoints = task.priority === 'high' ? 15 : task.priority === 'medium' ? 10 : 5;
                    setPoints(p => p - taskPoints);
                    
                    setDailyStats(prevStats => ({
                      ...prevStats,
                      [dateKey]: {
                        ...prevStats[dateKey],
                        completed: prevStats[dateKey].completed - 1,
                        points: prevStats[dateKey].points - taskPoints
                      }
                    }));
                  }
                  return { ...task, completed: newCompleted };
                }
                return task;
              })
            }));
          };

          const deleteTask = (dateKey, id) => {
            setTasks(prev => ({
              ...prev,
              [dateKey]: prev[dateKey].filter(task => task.id !== id)
            }));
          };

          const toggleHabit = (id) => {
            const today = formatDate(currentDate);
            const isCompleted = isHabitCompletedToday(id);
            
            if (!isCompleted) {
              setHabitCompletions(prev => ({
                ...prev,
                [today]: [...(prev[today] || []), id]
              }));
              
              setHabits(habits.map(habit => {
                if (habit.id === id) {
                  const lastDate = habit.lastCompleted ? new Date(habit.lastCompleted) : null;
                  const yesterday = new Date(currentDate);
                  yesterday.setDate(yesterday.getDate() - 1);
                  
                  const newStreak = lastDate && formatDate(lastDate) === formatDate(yesterday) 
                    ? habit.streak + 1 
                    : 1;
                  
                  return {
                    ...habit,
                    streak: newStreak,
                    lastCompleted: today
                  };
                }
                return habit;
              }));
              
              setPoints(p => p + 5);
            } else {
              setHabitCompletions(prev => ({
                ...prev,
                [today]: prev[today].filter(habitId => habitId !== id)
              }));
              
              setPoints(p => p - 5);
            }
          };

          const addHabit = () => {
            if (newHabit.trim()) {
              setHabits([...habits, { id: Date.now(), name: newHabit, streak: 0, lastCompleted: null }]);
              setNewHabit('');
            }
          };

          const startTimer = () => setIsTimerRunning(true);
          const pauseTimer = () => setIsTimerRunning(false);
          const resetTimer = () => {
            setIsTimerRunning(false);
            if (timerMode === 'focus') {
              setTimerMinutes(25);
              setTimerSeconds(0);
            } else {
              setTimerMinutes(5);
              setTimerSeconds(0);
            }
          };

          const switchMode = () => {
            setIsTimerRunning(false);
            if (timerMode === 'focus') {
              setTimerMode('break');
              setTimerMinutes(5);
              setTimerSeconds(0);
            } else {
              setTimerMode('focus');
              setTimerMinutes(25);
              setTimerSeconds(0);
            }
          };

          const addTimeBlock = () => {
            if (blockInput.trim()) {
              const dateKey = blockDate;
              setTimeBlocks(prev => ({
                ...prev,
                [dateKey]: [...(prev[dateKey] || []), { id: Date.now(), time: blockTime, task: blockInput, dateKey }]
              }));
              setBlockInput('');
              setBlockDate(formatDate(selectedDate));
            }
          };

          const getPriorityColor = (priority) => {
            switch(priority) {
              case 'high': return 'border-red-400 bg-red-50';
              case 'medium': return 'border-yellow-400 bg-yellow-50';
              case 'low': return 'border-green-400 bg-green-50';
              default: return 'border-gray-400 bg-gray-50';
            }
          };

          const motivationalMessages = [
            "You're doing amazing! üåü",
            "One task at a time! üí™",
            "Progress, not perfection! üéØ",
            "You've got this! ‚ö°",
            "Small steps = Big wins! üèÜ"
          ];

          const randomMessage = motivationalMessages[Math.floor(Math.random() * motivationalMessages.length)];

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-100 via-pink-100 to-blue-100 p-4">
              <div className="max-w-6xl mx-auto">
                <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
                  <div className="flex items-center justify-between mb-4">
                    <div>
                      <h1 className="text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                        ADHD Planner
                      </h1>
                      <p className="text-gray-600 mt-1">{randomMessage}</p>
                      <p className="text-lg font-semibold text-purple-600 mt-2">
                        üìÖ {currentDate.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}
                      </p>
                    </div>
                    <div className="text-right">
                      <div className="flex items-center gap-2 justify-end mb-2">
                        <Sparkles className="w-5 h-5 text-yellow-500" />
                        <span className="text-2xl font-bold text-purple-600">{points}</span>
                        <span className="text-gray-600">points</span>
                      </div>
                      <div className="text-sm text-gray-600">
                        ‚úÖ {getTodayStats().completed}/{getTodayStats().total} tasks completed
                      </div>
                      <div className="text-sm text-gray-600">
                        üî• {getTodayStats().focusSessions} focus sessions
                      </div>
                    </div>
                  </div>

                  <div className="flex items-center gap-3 mb-4 flex-wrap">
                    <button
                      onClick={() => {
                        const prev = new Date(selectedDate);
                        prev.setDate(prev.getDate() - 1);
                        setSelectedDate(prev);
                      }}
                      className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300"
                    >
                      ‚Üê Previous
                    </button>
                    
                    <button
                      onClick={() => setSelectedDate(new Date(currentDate))}
                      className={`px-6 py-2 rounded-lg font-medium ${
                        isToday(selectedDate) 
                          ? 'bg-purple-600 text-white' 
                          : 'bg-gray-200 hover:bg-gray-300'
                      }`}
                    >
                      Today
                    </button>
                    
                    <input
                      type="date"
                      value={formatDate(selectedDate)}
                      onChange={(e) => setSelectedDate(new Date(e.target.value + 'T00:00:00'))}
                      className="px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                    />
                    
                    <button
                      onClick={() => {
                        const next = new Date(selectedDate);
                        next.setDate(next.getDate() + 1);
                        setSelectedDate(next);
                      }}
                      className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300"
                    >
                      Next ‚Üí
                    </button>

                    {isToday(selectedDate) && (
                      <button
                        onClick={() => setShowReview(true)}
                        className="ml-auto px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                      >
                        üìä End Day Review
                      </button>
                    )}
                  </div>

                  {!isToday(selectedDate) && (
                    <div className={`px-4 py-2 rounded-lg text-center font-medium ${
                      isFuture(formatDate(selectedDate)) 
                        ? 'bg-blue-100 text-blue-700' 
                        : 'bg-gray-100 text-gray-700'
                    }`}>
                      {isFuture(formatDate(selectedDate)) ? 'üìÖ Planning for Future' : 'üìú Viewing Past Day'}
                    </div>
                  )}

                  <div className="flex gap-2 overflow-x-auto pb-2 mt-4">
                    {[
                      { id: 'today', label: 'Today Overview', icon: Target },
                      { id: 'brain-dump', label: 'Brain Dump', icon: Brain },
                      { id: 'tasks', label: 'Tasks', icon: Target },
                      { id: 'timer', label: 'Focus Timer', icon: Clock },
                      { id: 'habits', label: 'Habits', icon: TrendingUp },
                      { id: 'schedule', label: 'Schedule', icon: Zap }
                    ].map(tab => (
                      <button
                        key={tab.id}
                        onClick={() => setActiveTab(tab.id)}
                        className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all whitespace-nowrap ${
                          activeTab === tab.id
                            ? 'bg-purple-600 text-white shadow-lg'
                            : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                        }`}
                      >
                        <tab.icon className="w-4 h-4" />
                        {tab.label}
                      </button>
                    ))}
                  </div>
                </div>

                {showReview && (
                  <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full max-h-screen overflow-y-auto">
                      <h2 className="text-3xl font-bold text-gray-800 mb-6">üåü Today's Review</h2>
                      
                      <div className="space-y-4 mb-6">
                        <div className="bg-purple-50 border-2 border-purple-200 rounded-lg p-4">
                          <h3 className="font-bold text-lg mb-2">Tasks Completed</h3>
                          <p className="text-4xl font-bold text-purple-600">{getTodayStats().completed}/{getTodayStats().total}</p>
                        </div>
                        
                        <div className="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4">
                          <h3 className="font-bold text-lg mb-2">Points Earned</h3>
                          <p className="text-4xl font-bold text-yellow-600">{getTodayStats().points}</p>
                        </div>
                        
                        <div className="bg-orange-50 border-2 border-orange-200 rounded-lg p-4">
                          <h3 className="font-bold text-lg mb-2">Focus Sessions</h3>
                          <p className="text-4xl font-bold text-orange-600">{getTodayStats().focusSessions}</p>
                        </div>

                        <div className="bg-green-50 border-2 border-green-200 rounded-lg p-4">
                          <h3 className="font-bold text-lg mb-2">Habits Completed</h3>
                          <p className="text-4xl font-bold text-green-600">
                            {(habitCompletions[formatDate(currentDate)] || []).length}/{habits.length}
                          </p>
                        </div>
                      </div>
                      
                      <div className="bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-6">
                        <h3 className="font-bold text-lg mb-2">Tomorrow's Plan</h3>
                        <p className="text-gray-700">Ready to plan tomorrow? Head to the Tasks or Schedule tab!</p>
                      </div>

                      <button
                        onClick={() => setShowReview(false)}
                        className="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 font-medium text-lg"
                      >
                        Close Review
                      </button>
                    </div>
                  </div>
                )}

                {activeTab === 'today' && (
                  <div className="space-y-6">
                    <div className="bg-white rounded-2xl shadow-xl p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-4">Today at a Glance</h2>
                      
                      <div className="grid md:grid-cols-2 gap-4 mb-6">
                        <div className="bg-purple-50 border-2 border-purple-200 rounded-lg p-4">
                          <h3 className="font-bold text-lg mb-2">üìã Tasks</h3>
                          <p className="text-3xl font-bold text-purple-600">{getTodayStats().completed}/{getTodayStats().total}</p>
                          <p className="text-sm text-gray-600 mt-1">completed</p>
                        </div>
                        
                        <div className="bg-green-50 border-2 border-green-200 rounded-lg p-4">
                          <h3 className="font-bold text-lg mb-2">‚úÖ Habits</h3>
                          <p className="text-3xl font-bold text-green-600">
                            {(habitCompletions[formatDate(currentDate)] || []).length}/{habits.length}
                          </p>
                          <p className="text-sm text-gray-600 mt-1">completed</p>
                        </div>
                      </div>

                      <div className="space-y-3">
                        <h3 className="font-bold text-lg">Your Schedule Today</h3>
                        {getTodayBlocks().length > 0 ? (
                          <div className="space-y-2">
                            {getTodayBlocks().sort((a, b) => a.time.localeCompare(b.time)).map(block => (
                              <div key={block.id} className="bg-blue-50 border-2 border-blue-200 rounded-lg p-3 flex items-center gap-3">
                                <span className="font-bold text-blue-600">{block.time}</span>
                                <span className="text-gray-800">{block.task}</span>
                              </div>
                            ))}
                          </div>
                        ) : (
                          <p className="text-gray-500 text-center py-4">No time blocks scheduled yet</p>
                        )}
                      </div>
                    </div>

                    <div className="bg-white rounded-2xl shadow-xl p-6">
                      <h3 className="font-bold text-lg mb-3">High Priority Tasks</h3>
                      {getTodayTasks().filter(t => t.priority === 'high' && !t.completed).length > 0 ? (
                        <div className="space-y-2">
                          {getTodayTasks().filter(t => t.priority === 'high' && !t.completed).map(task => (
                            <div key={task.id} className="bg-red-50 border-2 border-red-300 rounded-lg p-3">
                              <p className="font-medium text-gray-800">{task.text}</p>
                              <p className="text-sm text-gray-600">‚è±Ô∏è {task.time} min</p>
                            </div>
                          ))}
                        </div>
                      ) : (
                        <p className="text-gray-500 text-center py-4">No high priority tasks! üéâ</p>
                      )}
                    </div>

                    <div className="bg-white rounded-2xl shadow-xl p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-4">üìÖ Monthly Calendar</h2>
                      
                      <div className="mb-4">
                        <div className="flex items-center justify-between mb-4">
                          <button
                            onClick={() => {
                              const prevMonth = new Date(selectedDate);
                              prevMonth.setMonth(prevMonth.getMonth() - 1);
                              setSelectedDate(prevMonth);
                            }}
                            className="px-4 py-2 bg-purple-100 rounded-lg hover:bg-purple-200 font-medium text-purple-700"
                          >
                            ‚Üê Prev
                          </button>
                          <h3 className="text-xl font-bold text-gray-800">
                            {selectedDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                          </h3>
                          <button
                            onClick={() => {
                              const nextMonth = new Date(selectedDate);
                              nextMonth.setMonth(nextMonth.getMonth() + 1);
                              setSelectedDate(nextMonth);
                            }}
                            className="px-4 py-2 bg-purple-100 rounded-lg hover:bg-purple-200 font-medium text-purple-700"
                          >
                            Next ‚Üí
                          </button>
                        </div>

                        <div className="grid grid-cols-7 gap-2">
                          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                            <div key={day} className="text-center font-bold text-gray-600 py-2 text-sm">
                              {day}
                            </div>
                          ))}
                          
                          {(() => {
                            const year = selectedDate.getFullYear();
                            const month = selectedDate.getMonth();
                            const firstDay = new Date(year, month, 1).getDay();
                            const daysInMonth = new Date(year, month + 1, 0).getDate();
                            const days = [];
                            
                            for (let i = 0; i < firstDay; i++) {
                              days.push(<div key={`empty-${i}`} className="aspect-square"></div>);
                            }
                            
                            for (let day = 1; day <= daysInMonth; day++) {
                              const date = new Date(year, month, day);
                              const dateKey = formatDate(date);
                              const isCurrentDay = dateKey === formatDate(currentDate);
                              const isSelected = dateKey === formatDate(selectedDate);
                              const hasTasks = tasks[dateKey]?.length > 0;
                              const hasBlocks = timeBlocks[dateKey]?.length > 0;
                              const hasHabits = habitCompletions[dateKey]?.length > 0;
                              
                              days.push(
                                <button
                                  key={day}
                                  onClick={() => setSelectedDate(date)}
                                  className={`aspect-square rounded-lg flex flex-col items-center justify-center relative transition-all hover:scale-105 ${
                                    isCurrentDay 
                                      ? 'bg-purple-600 text-white font-bold ring-2 ring-purple-400' 
                                      : isSelected
                                      ? 'bg-purple-200 text-purple-900 font-bold'
                                      : 'bg-gray-50 hover:bg-gray-100 text-gray-700'
                                  }`}
                                >
                                  <span className="text-sm">{day}</span>
                                  <div className="flex gap-1 mt-1">
                                    {hasTasks && (
                                      <div className={`w-1.5 h-1.5 rounded-full ${isCurrentDay || isSelected ? 'bg-white' : 'bg-purple-500'}`}></div>
                                    )}
                                    {hasBlocks && (
                                      <div className={`w-1.5 h-1.5 rounded-full ${isCurrentDay || isSelected ? 'bg-white' : 'bg-blue-500'}`}></div>
                                    )}
                                    {hasHabits && (
                                      <div className={`w-1.5 h-1.5 rounded-full ${isCurrentDay || isSelected ? 'bg-white' : 'bg-green-500'}`}></div>
                                    )}
                                  </div>
                                </button>
                              );
                            }
                            
                            return days;
                          })()}
                        </div>

                        <div className="mt-4 flex flex-wrap gap-4 justify-center text-sm">
                          <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded-full bg-purple-500"></div>
                            <span className="text-gray-600">Tasks</span>
                          </div>
                          <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded-full bg-blue-500"></div>
                            <span className="text-gray-600">Schedule</span>
                          </div>
                          <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded-full bg-green-500"></div>
                            <span className="text-gray-600">Habits</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {activeTab === 'brain-dump' && (
                  <div className="bg-white rounded-2xl shadow-xl p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      <Brain className="w-6 h-6 text-purple-600" />
                      Brain Dump - Get It Out!
                    </h2>
                    <p className="text-gray-600 mb-4">Capture those racing thoughts. Don't worry about organizing yet!</p>
                    
                    <div className="flex gap-2 mb-4">
                      <input
                        type="text"
                        value={brainInput}
                        onChange={(e) => setBrainInput(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && addBrainDump()}
                        placeholder="Type whatever's on your mind..."
                        className="flex-1 px-4 py-3 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                      />
                      <button
                        onClick={addBrainDump}
                        className="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors"
                      >
                        <Plus className="w-5 h-5" />
                      </button>
                    </div>

                    <div className="space-y-2">
                      {brainDump.map(item => (
                        <div key={item.id} className="bg-purple-50 border-2 border-purple-200 rounded-lg p-4 flex items-start justify-between">
                          <div className="flex-1">
                            <p className="text-gray-800">{item.text}</p>
                            <p className="text-xs text-gray-500 mt-1">{new Date(item.timestamp).toLocaleTimeString()}</p>
                          </div>
                          <button
                            onClick={() => setBrainDump(brainDump.filter(i => i.id !== item.id))}
                            className="text-red-500 hover:text-red-700"
                          >
                            <Trash2 className="w-4 h-4" />
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {activeTab === 'tasks' && (
                  <div className="bg-white rounded-2xl shadow-xl p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      <Target className="w-6 h-6 text-purple-600" />
                      Tasks for {formatDate(selectedDate) === formatDate(currentDate) ? 'Today' : selectedDate.toLocaleDateString()}
                    </h2>

                    <div className="mb-4 space-y-3">
                      <input
                        type="text"
                        value={taskInput}
                        onChange={(e) => setTaskInput(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && addTask()}
                        placeholder="What needs to be done?"
                        className="w-full px-4 py-3 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                      />
                      
                      <div className="flex gap-3 flex-wrap">
                        <select
                          value={taskPriority}
                          onChange={(e) => setTaskPriority(e.target.value)}
                          className="px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        >
                          <option value="low">Low Priority üü¢</option>
                          <option value="medium">Medium Priority üü°</option>
                          <option value="high">High Priority üî¥</option>
                        </select>

                        <select
                          value={taskTime}
                          onChange={(e) => setTaskTime(Number(e.target.value))}
                          className="px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        >
                          <option value={15}>15 min</option>
                          <option value={30}>30 min</option>
                          <option value={45}>45 min</option>
                          <option value={60}>1 hour</option>
                          <option value={120}>2 hours</option>
                        </select>

                        <input
                          type="date"
                          value={taskDate}
                          onChange={(e) => setTaskDate(e.target.value)}
                          className="px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        />

                        <button
                          onClick={addTask}
                          className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2"
                        >
                          <Plus className="w-5 h-5" />
                          Add Task
                        </button>
                      </div>
                    </div>

                    <div className="space-y-3">
                      {getSelectedDateTasks().length === 0 ? (
                        <p className="text-center text-gray-500 py-8">No tasks scheduled for this day</p>
                      ) : (
                        getSelectedDateTasks().map(task => {
                          const dateKey = formatDate(selectedDate);
                          return (
                            <div key={task.id} className={`border-2 rounded-lg p-4 ${getPriorityColor(task.priority)} ${task.completed ? 'opacity-50' : ''}`}>
                              <div className="flex items-start gap-3">
                                <button
                                  onClick={() => toggleTask(dateKey, task.id)}
                                  className="mt-1"
                                >
                                  {task.completed ? (
                                    <CheckCircle className="w-6 h-6 text-green-600" />
                                  ) : (
                                    <Circle className="w-6 h-6 text-gray-400" />
                                  )}
                                </button>
                                
                                <div className="flex-1">
                                  <p className={`font-medium ${task.completed ? 'line-through text-gray-500' : 'text-gray-800'}`}>
                                    {task.text}
                                  </p>
                                  <p className="text-sm text-gray-600 mt-1">
                                    ‚è±Ô∏è {task.time} min ‚Ä¢ {task.priority.toUpperCase()} priority
                                  </p>
                                </div>

                                <button
                                  onClick={() => deleteTask(dateKey, task.id)}
                                  className="text-red-500 hover:text-red-700"
                                >
                                  <Trash2 className="w-5 h-5" />
                                </button>
                              </div>
                            </div>
                          );
                        })
                      )}
                    </div>
                  </div>
                )}

                {activeTab === 'timer' && (
                  <div className="bg-white rounded-2xl shadow-xl p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      <Clock className="w-6 h-6 text-purple-600" />
                      Focus Timer (Pomodoro)
                    </h2>

                    <div className="text-center mb-6">
                      <div className={`inline-block px-6 py-2 rounded-full text-sm font-medium mb-4 ${
                        timerMode === 'focus' ? 'bg-purple-100 text-purple-700' : 'bg-green-100 text-green-700'
                      }`}>
                        {timerMode === 'focus' ? 'üéØ Focus Time' : '‚òï Break Time'}
                      </div>

                      <div className="text-8xl font-bold text-gray-800 mb-6">
                        {String(timerMinutes).padStart(2, '0')}:{String(timerSeconds).padStart(2, '0')}
                      </div>

                      <div className="flex gap-4 justify-center flex-wrap">
                        {!isTimerRunning ? (
                          <button
                            onClick={startTimer}
                            className="bg-green-500 text-white px-8 py-4 rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2 text-lg font-medium"
                          >
                            <Play className="w-6 h-6" />
                            Start
                          </button>
                        ) : (
                          <button
                            onClick={pauseTimer}
                            className="bg-yellow-500 text-white px-8 py-4 rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2 text-lg font-medium"
                          >
                            <Pause className="w-6 h-6" />
                            Pause
                          </button>
                        )}
                        
                        <button
                          onClick={resetTimer}
                          className="bg-gray-500 text-white px-8 py-4 rounded-lg hover:bg-gray-600 transition-colors flex items-center gap-2 text-lg font-medium"
                        >
                          <RotateCcw className="w-6 h-6" />
                          Reset
                        </button>

                        <button
                          onClick={switchMode}
                          className="bg-purple-500 text-white px-8 py-4 rounded-lg hover:bg-purple-600 transition-colors text-lg font-medium"
                        >
                          Switch to {timerMode === 'focus' ? 'Break' : 'Focus'}
                        </button>
                      </div>
                    </div>

                    <div className="bg-purple-50 border-2 border-purple-200 rounded-lg p-4">
                      <h3 className="font-bold text-gray-800 mb-2">How it works:</h3>
                      <ul className="space-y-1 text-sm text-gray-700">
                        <li>‚Ä¢ 25 minutes of focused work = +10 points</li>
                        <li>‚Ä¢ 5 minute break to recharge</li>
                        <li>‚Ä¢ Repeat 4 times, then take a longer break</li>
                        <li>‚Ä¢ One task at a time - you've got this! üí™</li>
                      </ul>
                    </div>
                  </div>
                )}

                {activeTab === 'habits' && (
                  <div className="bg-white rounded-2xl shadow-xl p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      <TrendingUp className="w-6 h-6 text-purple-600" />
                      Daily Habits
                    </h2>

                    {isToday(selectedDate) && (
                      <div className="flex gap-2 mb-6">
                        <input
                          type="text"
                          value={newHabit}
                          onChange={(e) => setNewHabit(e.target.value)}
                          onKeyPress={(e) => e.key === 'Enter' && addHabit()}
                          placeholder="Add a new habit..."
                          className="flex-1 px-4 py-3 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        />
                        <button
                          onClick={addHabit}
                          className="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors"
                        >
                          <Plus className="w-5 h-5" />
                        </button>
                      </div>
                    )}

                    <div className="grid gap-4 md:grid-cols-2">
                      {habits.map(habit => {
                        const isCompleted = isHabitCompletedToday(habit.id);
                        return (
                          <div
                            key={habit.id}
                            className={`border-2 rounded-lg p-4 ${
                              isToday(selectedDate) ? 'cursor-pointer' : ''
                            } transition-all ${
                              isCompleted
                                ? 'bg-green-50 border-green-400'
                                : 'bg-gray-50 border-gray-300 hover:border-purple-400'
                            }`}
                            onClick={() => isToday(selectedDate) && toggleHabit(habit.id)}
                          >
                            <div className="flex items-center justify-between mb-2">
                              <h3 className="font-bold text-gray-800">{habit.name}</h3>
                              {isCompleted ? (
                                <CheckCircle className="w-6 h-6 text-green-600" />
                              ) : (
                                <Circle className="w-6 h-6 text-gray-400" />
                              )}
                            </div>
                            <div className="flex items-center gap-2">
                              <span className="text-2xl">üî•</span>
                              <span className="font-bold text-orange-600">{habit.streak}</span>
                              <span className="text-sm text-gray-600">day streak</span>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                )}

                {activeTab === 'schedule' && (
                  <div className="bg-white rounded-2xl shadow-xl p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      <Zap className="w-6 h-6 text-purple-600" />
                      Time Blocking Schedule
                    </h2>

                    <div className="mb-4 space-y-3">
                      <div className="flex gap-3 flex-wrap">
                        <input
                          type="time"
                          value={blockTime}
                          onChange={(e) => setBlockTime(e.target.value)}
                          className="px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        />
                        <input
                          type="text"
                          value={blockInput}
                          onChange={(e) => setBlockInput(e.target.value)}
                          onKeyPress={(e) => e.key === 'Enter' && addTimeBlock()}
                          placeholder="What are you doing?"
                          className="flex-1 px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        />
                        <input
                          type="date"
                          value={blockDate}
                          onChange={(e) => setBlockDate(e.target.value)}
                          className="px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        />
                        <button
                          onClick={addTimeBlock}
                          className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors"
                        >
                          <Plus className="w-5 h-5" />
                        </button>
                      </div>
                    </div>

                    <div className="space-y-2">
                      {getSelectedDateBlocks().length === 0 ? (
                        <div className="text-center py-12 text-gray-500">
                          <Clock className="w-12 h-12 mx-auto mb-3 opacity-50" />
                          <p>No time blocks scheduled for this day</p>
                        </div>
                      ) : (
                        getSelectedDateBlocks().sort((a, b) => a.time.localeCompare(b.time)).map(block => {
                          const dateKey = formatDate(selectedDate);
                          
                          return (
                            <div key={block.id} className="bg-blue-50 border-2 border-blue-200 rounded-lg p-4">
                              <div className="flex items-center justify-between">
                                <div className="flex items-center gap-4 flex-1">
                                  <span className="font-bold text-blue-600 text-lg">{block.time}</span>
                                  <span className="text-gray-800">{block.task}</span>
                                </div>
                                <button
                                  onClick={() => setTimeBlocks(prev => ({
                                    ...prev,
                                    [dateKey]: prev[dateKey].filter(b => b.id !== block.id)
                                  }))}
                                  className="text-red-500 hover:text-red-700"
                                >
                                  <Trash2 className="w-4 h-4" />
                                </button>
                              </div>
                            </div>
                          );
                        })
                      )}
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<ADHDPlanner />, document.getElementById('root'));

        // Register service worker
        if ('serviceWorker' in navigator) {
          window.addEventListener('load', () => {
            navigator.serviceWorker.register('/service-worker.js')
              .then(reg => console.log('Service Worker registered'))
              .catch(err => console.log('Service Worker registration failed'));
          });
        }
    </script>
</body>
</html>
